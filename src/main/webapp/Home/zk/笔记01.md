**zookeeper** 
    
    zookeeper解决分布式一致性问题
        
    zookeeper实现分布式锁问题
        
    zookeeper的数据同步
            当客户端请求过来时，需要满足，事务型数据和非事务型数据的分开处理方式，就是
        leader 节点可以处理事务和非事务型数据。而 follower 节点只能处理非事务型数据。原因是，
        对于数据变更的操作，应该由一个节点来维护，使得集群数据处理的简化。同时数据需要能
        够通过 leader 进行分发使得数据在集群中各个节点的一致性
            leader 节点如何和其他节点保证数据一致性，并且要求是强一致的。在分布式系统中，每一个机器节点虽然都能够明确知道自己进行的事务操作过程是成功和失败，
        但是却无法直接获取其他分布式节点的操作结果。所以当一个事务操作涉及到跨节点的时候，就需要用到分布式事务，
        分布式事务的数据一致性协议有 2PC 协议和 3PC 协议
        
    关于2PC提交
            当一个事务操作需要跨越多个分布式节点的时候，为了保持事务处理的 ACID 特性，就需要引入一个“协调者”（TM）来统一调度所有分布式节点
        的执行逻辑，这些被调度的分布式节点被称为 AP。TM 负责调度 AP 的行为，并最终决定这些 AP 是否要把事务真正进行提交；
        因为整个事务是分为两个阶段提交，所以叫 2pc！
        阶段一：    提交事务请求（投票）
            1. 事务询问协调者向所有的参与者发送事务内容，询问是否可以执行事务提交操作，并开始等待各参与者的响应
            2. 执行事务各个参与者节点执行事务操作，并将 Undo 和 Redo 信息记录到事务日志中，尽量把提交过程中所有消耗时间的操作和准备都提前完成确保后面 
                100%成功提交事务
            3. 各个参与者向协调者反馈事务询问的响应如果各个参与者成功执行了事务操作，那么就反馈给参与者 yes 的响应，表示事务可以执行；
                如果参与者没有成功执行事务，就反馈给协调者 no 的响应，表示事务不可以执行，上面这个阶段有点类似协调者组织各个参与者对一次事务操作的投票表态过程，
                因此 2pc 协议的第一个阶段称为“投票阶段”，即各参与者投票表名是否需要继续执行接下去的事务提交操作。
        阶段二：    执行事务提交
            在这个阶段，协调者会根据各参与者的反馈情况来决定最终是否可以进行事务提交操作，正常情况
            下包含两种可能:执行事务、中断事务（超过半数机制）
            
    leader：
        Leader 服务器是整个 zookeeper 集群的核心，主要的工作任务有两项
        1. 事物请求的唯一调度和处理者，保证集群事物处理的顺序性
        2. 集群内部各服务器的调度者
    followe：
        Follower 角色的主要职责是
        1. 处理客户端非事物请求、转发事物请求给 leader 服务器
        2. 参与事物请求 Proposal 的投票（需要半数以上服务器通过才能通知 leader commit 数据; 
           Leader 发起的提案，要求 Follower 投票）
        3. 参与 Leader 选举的投票    
    Observer：
            Observer 是 zookeeper3.3 开始引入的一个全新的服务器角色，从字面来理解，该角色充当了观察者的角色。
        观察 zookeeper 集群中的最新状态变化并将这些状态变化同步到 observer 服务器上。Observer 的工作原理与 follower 角色基本一致，
        而它和 follower 角色唯一的不同在于observer 不参与任何形式的投票，包括事物请求 Proposal 的投票和 leader 选举的投票。
        简单来说，observer 服务器只提供非事物请求服务，通常在于不影响集群事物处理能力的前提下提升集群非事物处理的能力
        
    zk节点特性：
        1 持久化节点     创建后会一直存在 zookeeper 服务器上，直到主动删除
        2 临时节点       临时节点的生命周期和客户端的会话绑定在一起，当客户端会话失效该节点自动清理
        3 顺序节点       每个节点都会为它的一级子节点维护一个顺序   
        4 临时节点下面不能有子节点
        5 同一级节点的名称不能相同
        6 3.5.5版本ttl 和容器节点
        7 watch机制
        
    zk安装注意点：
        单机：
            一般情况下，在开发测试环境，没有这么多资源的情况下，而且也不需要特别好的稳定性的前提下，我们可以使用单机部署；初次使用zookeeper，
            需要将 conf目录下的zoo_sample.cfg 文件 copy 一份重命名为 zoo.cfg修改 dataDir 目录，dataDir 表示日志文件存放的路径。
        集群：
            1. 修改配置文件
            修改端口
            server.1=IP1:288 8:3888 【2888：访问 zookeeper 的端口；3888：重新选举 leader 的端口】
            server.2=IP2.2888:3888
            server.3=IP3.2888:2888
                server.A=B：C：D：其 中A 是一个数字，表示这个是第几号服务器；B 是这个服务器的 ip 地址；
                C 表示的是这个服务器与集群中的 Leader 服务器交换信息的端口；D 表示的是万一集群中的 Leader 服务器挂了，需要一个端口来重新进行选举，
            2. 新建 datadir 目录，
            设置 myid在每台 zookeeper 机器上，我们都需要在数据目录(dataDir)下创建一个 myid 文件，该文件只有一行内容，
            对应每台机器的 Server ID 数字；比如 server.1 的 myid 文件内容就是 1。【必须确保每个服务器的 myid 文件中的数字不同，
            并且和自己所在机器的 zoo.cfg 中 server.id的 id 值一致，id 的范围是 1~255】
            3 启动
            
            
            
            
            
            
            
            
            
            
            
                
        