<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width"/>
    <title>标题</title>
    <link href="../../Content/css/framework-font.css" rel="stylesheet"/>
    <link href="../../Content/css/framework-theme.css" rel="stylesheet"/>
    <script src="../../Content/js/jquery/jquery-2.1.1.min.js"></script>
    <script src="../../Content/js/bootstrap/bootstrap.js"></script>
    <link href="../../Content/js/bootstrap/bootstrap.min.css" rel="stylesheet"/>
    <script src="../../Content/js/jqgrid/jqgrid.min.js"></script>
    <link href="../../Content/js/jqgrid/jqgrid.css" rel="stylesheet"/>
    <link href="../../Content/js/select2/select2.min.css" rel="stylesheet"/>
    <script src="../../Content/js/select2/select2.min.js"></script>
    <link href="../../Content/js/wizard/wizard.css" rel="stylesheet"/>
    <script src="../../Content/js/wizard/wizard.js"></script>
    <script src="../../Content/js/jqgrid/grid.locale-cn.js"></script>
    <link href="../../Content/css/framework-ui.css" rel="stylesheet"/>
    <script src="../../Content/js/framework-ui.js"></script>
    <style>
        .c-a{
            color: #1890FF;
        }
    </style>
    <script>
        $(function () {

            //查询
            $("#btn_search").click(function () {
                $("#gridList").jqGrid('setGridParam', {
                    postData: {
                        keyword: $("#txt_keyword").val()
                    }
                }).trigger('reloadGrid');
            });

            //重置
            $("#btn_reset").click(function () {
                $("#txt_keyword").val("");
                $("#gridList").clearGridData();
                $("#gridList").jqGrid('setGridParam', {
                    page:1,//回到第一页
                    postData: {
                        keyword: $("#txt_keyword").val()
                    }
                }).trigger('reloadGrid');
            });


            //默认加载数据
            init();

            /**
             * 加载数据
             */
            function init() {
                $("#gridList").jqGrid({
                    url: $.sysStaticData().urlExt + "/aviInfo/queryDeviceList",
                    datatype: "json",
                    mtype: "POST",
                    height: $(window).height() - 128,
                    postData: {
                        keyword: $("#txt_keyword").val()
                    },
                    jsonReader: {
                        total: "totalPage",
                        page: "currentPage",
                        records: "totalResult",
                        root: "list",
                        id: "deviceNO"
                    },
                    rownumbers:true,
                    autowidth: true,
                    colNames: ["设备描述", "录像列表", "签字人像列表","签字列表", "数量", "最新更新", "操作"],
                    colModel: [

                        {name: 'deviceName', align: 'left'},
                        {
                            name: 'deviceNO', align: 'center',
                            formatter: function (cellvalue) {
                                return "<a class=\"fa c-a\" data-type='2'>查看</a>";
                            }
                        },
                        {
                            name: 'deviceNO', align: 'center',
                            formatter: function (cellvalue) {
                                return "<a class=\"fa c-a\" data-type='1'>查看</a>";
                            }
                        },
                        {
                            name: 'deviceNO', align: 'center',
                            formatter: function (cellvalue) {
                                return "<a class=\"fa c-a\" data-type='3'>查看</a>";
                            }
                        },
                        {name: 'num', align: 'center'},

                        {
                            name: 'maxtime', align: 'center',
                            formatter: function (value, row, index) {
                                return $.changeDateFormat(value).DateExt;
                            }
                        },
                        {
                            name: 'operate', align: 'center',
                            formatter: function (value, row, index) {
                                return "<a class=\"fa c-a\">管理</a>";
                            }
                        }

                    ],
                    pager: "#gridPager",
                    sortname: 'sortCode',
                    viewrecords: true,
                    gridComplete:function () {
                        $(".c-a").click(function () {
                            var type = $(this).data("type") || "";
                            var deviceNo = $(this).parents("tr").attr("id");
                            var deviceName = $(this).parents("tr").find("td[aria-describedby='gridList_deviceName']").text();
                            $.modalOpen({
                                id: "list",
                                title: "录像及签字人像",
                                url: $.sysStaticData().urlExt + "/ContentManage/VideoSigin/List.html?deviceNo=" + deviceNo+"&type="+type+"&deviceName="+encodeURI(deviceName),
                                width: "900px",
                                height: "860px",
                                btn: null,
                            });
                        })
                    }
                });
                $("#gridList").jqGrid('setLabel',0, '序号');
            }


        });


    </script>
</head>
<body>
<div class="topPanel">
    <div class="toolbar">
        <div class="btn-group">
            <a class="btn btn-primary" onclick="$.reload()"><span class="glyphicon glyphicon-refresh"></span></a>
        </div>
        <!-- <div class="btn-group">
             <a id="NF-add" authorize="yes" class="btn btn-primary dropdown-text" onclick="btn_add()"><i class="fa fa-plus"></i>新增公告</a>
         </div>
         <div class="operate">
             <ul class="nav nav-pills">
                 <li class="first">已选中<span>1</span>项</li>
                 <li><a id="NF-edit" authorize="yes" onclick="btn_edit()"><i class="fa fa-pencil-square-o"></i>查看录像列表</a></li>
                 <li><a id="NF-delete" authorize="yes" onclick="btn_delete()"><i class="fa fa-trash-o"></i>查看签字人像列表</a></li>
                 <li><a id="NF-Details" authorize="yes" onclick="btn_details()"><i class="fa fa-search-plus"></i>查看公告</a></li>
                 <li><a id="NF-Details" authorize="yes" onclick="btn_publish()"><i class="fa fa-search-plus"></i>发布公告</a></li>
             </ul>
             <a href="javascript:;" class="close"></a>
         </div>-->
        <!-- <script>//$('.toolbar').authorizeButton()</script>-->
    </div>
    <div class="search">
        <table>
            <tr>
                <th class="formTitle" style="padding:0px 10px 0px 20px">设备描述</th>
                <td>
                    <div class="input-group">
                        <input id="txt_keyword" type="text" class="form-control" placeholder="请输入"
                               style="width: 200px;">
                        <span class="input-group-btn">
                            <button id="btn_search" type="button" class="btn  btn-primary"><i class="fa fa-search"></i></button>
                        </span>
                    </div>
                </td>
                <td>
                    <button id="btn_reset" type="button" class="btn  btn-default" style="margin-left: 10px;">重置</button>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="gridPanel">
    <table id="gridList"></table>
    <div id="gridPager"></div>
</div>
</body>
</html>